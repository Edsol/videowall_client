<!DOCTYPE html>
<html>

<head>
  <title>
    <%= title %>
  </title>
  <link rel='stylesheet' href='/stylesheets/style.css' />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
    integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
    crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.24.0/axios.min.js"
    integrity="sha512-u9akINsQsAkG9xjc1cnGF4zw5TFDwkxuc9vUp5dltDWYCSmyd0meygbvgXrlc/z7/o4a19Fb5V0OUE58J7dcyw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
  <div class="">
    <input type="text" name="url" id="url" placeholder='example.com'>
    <button id='send' class='btn btn-sm btn-primary'>Load</button>
  </div>

  <hr>

  <div class="">
    <input type="text" name="hostname" id="hostname" placeholder='hostname' value='<%- hostname %>' >
    <button id='send' class='btn btn-sm btn-primary setHostname'>Set</button>
  </div>

  <script>
    $("#url").on("keypress", function (event) {
      var keycode = (event.keyCode ? event.keyCode : event.which);

      if (keycode == '13') {
        $('#send').trigger('click');
      }

    });
    $('#send').on('click', (event) => {
      axios.post('run', { url: $('#url').val() })
        .then((response) => {
          if (response.data.executed) {
            console.log('executed');
            $('#url').val('');
          } else {
            console.log(response.data.errors)
          }

        })
    })

    $('.setHostname').on('click',event =>{
      var hostname = $('#hostname').val();
      if(hostname === ''){
        console.log('no hostname');
        return;
      }
      axios.get('/setHostname/'+hostname)
      .then((response) =>{
        console.log(response.data)
        if(response.data){
          console.log('executed')
        }
      })
    })
  </script>
</body>

</html>